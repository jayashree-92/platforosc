

pool:
  vmImage: 'windows-latest'

steps:
  - task: UseDotNet@2
    displayName: 'Install .NET Core SDK'
    inputs:
      version: 8.x
      performMultiLevelLookup: true
      includePreviewVersions: true

  - task: PowerShell@2
    displayName: 'Install NAnt'
    inputs:
      targetType: 'inline'
      script: |
        # Download NAnt
        Invoke-WebRequest -Uri 'https://sourceforge.net/projects/nant/files/latest/download' -OutFile 'nant.zip'
        Add-Type -AssemblyName System.IO.Compression.FileSystem
        [System.IO.Compression.ZipFile]::ExtractToDirectory('nant.zip', 'C:\Nant')
        Remove-Item -Path 'nant.zip' -Force

        # Add NAnt to PATH
        $env:PATH += ';$(Agent.ToolsDirectory)\Nant\bin'
        Write-Host 'NAnt installed successfully.'

